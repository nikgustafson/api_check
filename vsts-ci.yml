# Docker image
# Build a Docker image to run, deploy, or push to a container registry.
# Add steps that use Docker Compose, tag images, push to a registry, run an image, and more:
# https://docs.microsoft.com/vsts/pipelines/languages/docker
# multiple jobs get run in paralell/out of order

jobs:
- job: 'RunTests'
  steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.6'
      architecture: 'x64'
  - script: . setup.sh
  - script: pip install -r panoptes/requirements.txt
    displayName: 'Install Requirements'
  - script: |
      pip install pytest
      pip install pytest-cov
      mkdir logs
      pytest panoptes  --junitxml=logs/test-results.xml --cov=com --cov-report=xml --cov-report=html
    displayName: 'Test with pytest'

